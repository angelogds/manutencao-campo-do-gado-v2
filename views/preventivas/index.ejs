<% layout("layout") %>

<style>
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:14px}
  .muted{color:#6b7280}
  .btn{display:inline-block;padding:10px 12px;border-radius:10px;border:1px solid #e5e7eb;background:#fff;font-weight:800;cursor:pointer;text-decoration:none}
  .btn:hover{border-color:#16a34a;color:#16a34a}
  table{width:100%;border-collapse:collapse}
  th,td{padding:10px;border-bottom:1px solid #eef2f7;text-align:left;font-size:14px}
  th{font-size:12px;color:#6b7280;text-transform:uppercase;letter-spacing:.04em}
  .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#f3f4f6;font-weight:800;font-size:12px}
</style>

<h1>Preventivas</h1>
<p class="muted" style="margin-top:-6px;">Planos de manutenção preventiva</p>

<div class="row" style="margin:10px 0 14px;">
  <a class="btn" href="/preventivas/nova">+ Nova Preventiva</a>
</div>

<div class="card">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Título</th>
        <th>Equipamento</th>
        <th>Frequência</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <% if (!lista?.length) { %>
        <tr><td colspan="5" class="muted">Nenhuma preventiva cadastrada.</td></tr>
      <% } %>

      <% lista.forEach(p => { %>
        <tr>
          <td><a href="/preventivas/<%= p.id %>">#<%= p.id %></a></td>
          <td><strong><%= p.titulo %></strong></td>
          <td class="muted">
            <%= p.equipamento_nome ? (p.equipamento_codigo ? (p.equipamento_codigo + " • " + p.equipamento_nome) : p.equipamento_nome) : "-" %>
          </td>
          <td>
            <span class="pill"><%= (p.frequencia_tipo || "").toUpperCase() %></span>
            <span class="muted">x<%= p.frequencia_valor || 1 %></span>
          </td>
          <td>
            <span class="pill"><%= (p.ativo ? "ATIVA" : "INATIVA") %></span>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

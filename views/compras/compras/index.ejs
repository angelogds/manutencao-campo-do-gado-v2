<% layout('layout') %>

<style>
  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin:12px 0; }
  .card{ background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:14px; }
  .btn-mini{
    display:inline-flex; align-items:center; justify-content:center;
    padding:8px 10px; border-radius:12px; border:1px solid #e5e7eb;
    background:#fff; font-weight:900; font-size:13px; color:#111827;
    text-decoration:none; transition: all .15s ease;
  }
  .btn-mini:hover{ background:#0f7a3a; border-color:#0f7a3a; color:#fff; transform: translateY(-1px); }
  table{ width:100%; border-collapse:collapse; }
  th,td{ padding:10px; border-bottom:1px solid #e5e7eb; text-align:left; font-size:14px; }
  th{ color:#6b7280; font-size:12px; letter-spacing:.04em; text-transform:uppercase; }
  .pill{ font-size:12px; font-weight:900; padding:4px 10px; border-radius:999px; background:#f3f4f6; border:1px solid #e5e7eb; }
</style>

<h1>Compras</h1>
<p style="color:#6b7280; margin-top:-6px;">Registro de compras / recebimentos.</p>

<div class="row">
  <a class="btn-mini" href="/compras/new">Nova compra</a>
  <a class="btn-mini" href="/compras?status=em_andamento">Em andamento</a>
  <a class="btn-mini" href="/compras?status=recebida">Recebidas</a>
  <a class="btn-mini" href="/compras">Todas</a>
  <% if (status) { %>
    <span class="pill">Filtro: <%= status %></span>
  <% } %>
</div>

<div class="card">
  <table>
    <thead>
      <tr>
        <th>ID</th>
        <th>Fornecedor</th>
        <th>Status</th>
        <th>Data compra</th>
        <th></th>
      </tr>
    </thead>
    <tbody>
      <% if (!lista || lista.length === 0) { %>
        <tr><td colspan="5" style="color:#6b7280;">Nenhuma compra encontrada.</td></tr>
      <% } %>

      <% (lista || []).forEach(c => { %>
        <tr>
          <td>#<%= c.id %></td>
          <td><%= c.fornecedor || "-" %></td>
          <td><span class="pill"><%= c.status %></span></td>
          <td><%= c.data_compra || "-" %></td>
          <td><a class="btn-mini" href="/compras/<%= c.id %>">Abrir</a></td>
        </tr>
      <% }) %>
    </tbody>
  </table>
</div>

<% layout('layout') %>

<div class="page-head">
  <div>
    <h1>Dashboard</h1>
    <p class="muted">Painel de Manutenção</p>
  </div>
</div>

<div class="grid-2" style="grid-template-columns:repeat(2,minmax(0,1fr)); gap:14px;">

  <!-- ORDEM DE SERVIÇO -->
  <div class="card">
    <div class="label">Ordem de Serviço</div>
    <div style="font-size:22px; font-weight:900; margin-top:6px;">
      Abertas
    </div>

    <div style="margin-top:12px;">
      <span class="pill-tag pill-amber">
        <%= cards.os_abertas %> em andamento
      </span>
    </div>

    <div style="margin-top:14px;">
      <a class="btn btn-green btn-sm" href="/os">
        Acompanhar OS
      </a>
    </div>
  </div>

  <!-- PREVENTIVAS -->
  <div class="card">
    <div class="label">Preventivas</div>
    <div style="font-size:22px; font-weight:900; margin-top:6px;">
      Programadas
    </div>

    <div style="margin-top:12px;">
      <span class="pill-tag pill-blue">
        <%= cards.preventivas %> ativas
      </span>
    </div>

    <div style="margin-top:14px;">
      <% if (preventivas.length) { %>
        <% preventivas.forEach(p => { %>
          <div style="margin-bottom:6px;">
            • <strong><%= p.equipamento_nome %></strong>
            (<%= p.periodicidade_dias %> dias)
          </div>
        <% }) %>
      <% } else { %>
        <div class="muted">Nenhuma preventiva cadastrada.</div>
      <% } %>
    </div>
  </div>

  <!-- MOTORES -->
  <div class="card">
    <div class="label">Motores</div>
    <div style="font-size:22px; font-weight:900; margin-top:6px;">
      Controle
    </div>

    <div style="display:flex; gap:10px; margin-top:12px; flex-wrap:wrap;">
      <span class="pill-tag pill-green">
        Na empresa: <%= cards.motores_empresa %>
      </span>

      <% if (cards.motores_conserto > 0) { %>
        <span class="pill-tag pill-amber">
          Em conserto: <%= cards.motores_conserto %>
        </span>
      <% } else { %>
        <span class="pill-tag pill-green">
          Nenhum em conserto
        </span>
      <% } %>
    </div>

    <div style="margin-top:14px;">
      <a class="btn btn-green btn-sm" href="/motores">
        Ver motores
      </a>
    </div>
  </div>

  <!-- ESCALA -->
  <div class="card">
    <div class="label">Escala da Semana</div>
    <div style="font-size:22px; font-weight:900; margin-top:6px;">
      Plantão Atual
    </div>

    <div style="margin-top:12px;">
      <% if (escala) { %>
        <div><strong>Turno Dia:</strong> <%= escala.turno_dia || '-' %></div>
        <div><strong>Turno Noite:</strong> <%= escala.turno_noite || '-' %></div>
      <% } else { %>
        <div class="muted">Escala não disponível.</div>
      <% } %>
    </div>

    <div style="margin-top:14px;">
      <a class="btn btn-green btn-sm" href="/escala">
        Ver escala completa
      </a>
    </div>
  </div>

</div>

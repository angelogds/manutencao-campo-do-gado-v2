<!-- views/partials/sidebar.ejs -->
<%
  const role = String(user?.role || "").toUpperCase();

  const isAdmin = role === "ADMIN";
  const isAlmox = role === "ALMOXARIFE";
  const isDirecao = role === "DIRECAO" || role === "DIRETORIA";
  const isCompras = role === "COMPRAS";
  const isEncarregadoProd = role === "ENCARREGADO_PRODUCAO";

  const canAlmoxArea = isAdmin || isAlmox; // Almoxarife + Motores
  const canEstoque = isAdmin || isAlmox;
  const canMotores = isAdmin || isAlmox;

  // Compras: (ajuste se você quiser leitura p/ direção/encarregado)
  const canCompras = isAdmin || isCompras || isAlmox || isDirecao || isEncarregadoProd;
  const canSolicitacoes = canCompras;
  const canAlmoxarifado = isAdmin || isAlmox || isCompras;
  const canDemandas = isAdmin || isDirecao;

  const canUsuarios = isAdmin;
%>

<aside class="sidebar">
  <div class="brand">
    <div class="brand-badge">CG</div>
    <div class="brand-text">
      <div class="brand-title">Campo do Gado</div>
      <div class="brand-sub">V2 • Gestão Industrial</div>
    </div>
  </div>

  <nav class="nav">
    <a class="nav-item <%= activeMenu === 'dashboard' ? 'active' : '' %>" href="/dashboard">
      Painel Principal
    </a>

    <a class="nav-item <%= activeMenu === 'equipamentos' ? 'active' : '' %>" href="/equipamentos">
      Equipamentos
    </a>

    <a class="nav-item <%= activeMenu === 'os' ? 'active' : '' %>" href="/os">
      Ordens de Serviço
    </a>

    <a class="nav-item <%= activeMenu === 'preventivas' ? 'active' : '' %>" href="/preventivas">
      Preventivas
    </a>

    <% if (canDemandas) { %>
      <a class="nav-item <%= activeMenu === 'demandas' ? 'active' : '' %>" href="/demandas">
        Demandas
      </a>
    <% } %>

    <% if (canSolicitacoes) { %>
      <a class="nav-item <%= activeMenu === 'solicitacoes' ? 'active' : '' %>" href="/solicitacoes">
        Solicitações
      </a>
    <% } %>

    <% if (canCompras) { %>
      <a class="nav-item <%= activeMenu === 'compras' ? 'active' : '' %>" href="/compras">
        Compras
      </a>
    <% } %>

    <% if (canAlmoxarifado) { %>
      <a class="nav-item <%= activeMenu === 'almoxarifado' ? 'active' : '' %>" href="/almoxarifado">
        Almoxarifado
      </a>
    <% } %>

    <% if (canEstoque) { %>
      <a class="nav-item <%= activeMenu === 'estoque' ? 'active' : '' %>" href="/estoque">
        Estoque
      </a>
    <% } %>

    <% if (canAlmoxarifado) { %>
      <a class="nav-item <%= activeMenu === 'almoxarifado' ? 'active' : '' %>" href="/almoxarifado">
        Almoxarifado
      </a>
    <% } %>

    <% if (canMotores) { %>
      <a class="nav-item <%= activeMenu === 'motores' ? 'active' : '' %>" href="/motores">
        Motores
      </a>
    <% } %>

    <a class="nav-item <%= activeMenu === 'escala' ? 'active' : '' %>" href="/escala">
      Escala
    </a>

    <div class="nav-divider"></div>

    <% if (canUsuarios) { %>
      <div class="nav-section">ADMIN</div>
      <a class="nav-item <%= activeMenu === 'usuarios' ? 'active' : '' %>" href="/usuarios">
        Gerenciar Usuários
      </a>
    <% } %>
  </nav>

  <div class="sidebar-footer">
    <small>© <%= new Date().getFullYear() %> Campo do Gado</small>
  </div>
</aside>

<% layout('layout') %>

<section class="auth">
  <div class="card auth-card">
    <h2>Entrar</h2>

    <!-- ===== FLASH ERROR ===== -->
    <% if (typeof flash !== 'undefined' && flash.error && flash.error.length > 0) { %>
      <div class="alert alert-error">
        <%= flash.error[0] %>
      </div>
    <% } %>

    <!-- ===== FLASH SUCCESS ===== -->
    <% if (typeof flash !== 'undefined' && flash.success && flash.success.length > 0) { %>
      <div class="alert alert-success">
        <%= flash.success[0] %>
      </div>
    <% } %>

    <!-- ===== BLOQUEIO TEMPORÃRIO ===== -->
    <% if (typeof lockout !== 'undefined' && lockout) { %>
      <div class="alert alert-error">
        Muitas tentativas. Aguarde
        <b><%= lockout.remainingSeconds %></b>
        segundos e tente novamente.
      </div>
    <% } %>

    <!-- ===== TENTATIVAS RESTANTES ===== -->
    <% if (typeof attemptsLeft !== 'undefined' && attemptsLeft !== null) { %>
      <div class="alert alert-info">
        Tentativas restantes:
        <b><%= attemptsLeft %></b>
      </div>
    <% } %>

    <!-- ===== FORM LOGIN ===== -->
    <form action="/auth/login" method="POST" autocomplete="on">
      
      <label>Email</label>
      <input
        type="email"
        name="email"
        value="<%= typeof rememberedEmail !== 'undefined' ? rememberedEmail : '' %>"
        required
        autocomplete="email"
      />

      <label>Senha</label>
      <input
        type="password"
        name="password"
        required
        autocomplete="current-password"
      />

      <button type="submit">Entrar</button>
    </form>

  </div>
</section>

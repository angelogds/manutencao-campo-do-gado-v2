<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><%= title || "Manutenção Campo do Gado" %></title>

  <link rel="stylesheet" href="/css/app.css" />

  <!-- Menu lateral no padrão das views (verde #16a34a) -->
  <style>
    :root{
      --cg-green: #16a34a;        /* MESMO verde do botão Equipamentos */
      --cg-green-dark: #15803d;   /* hover do botão */
      --cg-green-soft: #ecfdf5;   /* fundo suave */
      --cg-border: rgba(22,163,74,.35);
    }

    /* Nav item base */
    .nav-item{
      position: relative;
      transition: background .15s ease, transform .08s ease, color .15s ease, outline-color .15s ease;
      border-radius:14px;
    }

    /* Hover leve */
    .nav-item:hover{
      background: rgba(255,255,255,.12);
      transform: translateY(-1px);
      color:#fff;
    }

    /* Ativo com “fio verde” + fundo sutil */
    .nav-item.active{
      background: rgba(255,255,255,.14);
      outline: 1px solid rgba(255,255,255,.18);
      color:#fff;
      font-weight: 800;
    }

    /* Fio verde (barra na esquerda) */
    .nav-item.active::before{
      content:"";
      position:absolute;
      left:8px;
      top:10px;
      bottom:10px;
      width:4px;
      border-radius:999px;
      background: var(--cg-green);
      box-shadow: 0 0 0 3px rgba(22,163,74,.18);
    }

    /* Dá espaço pro fio */
    .nav-item{ padding-left: 18px; }
    .nav-item.active{ padding-left: 28px; }

    /* Área ADMIN mais leve */
    .nav-section{
      margin-top:4px;
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-badge">CG</div>
        <div class="brand-text">
          <div class="brand-title">Campo do Gado</div>
          <div class="brand-sub">V2 • Gestão Industrial</div>
        </div>
      </div>

      <nav class="nav">
        <a class="nav-item <%= activeMenu === 'dashboard' ? 'active' : '' %>" href="/dashboard">
          Painel
        </a>

        <a class="nav-item <%= activeMenu === 'equipamentos' ? 'active' : '' %>" href="/equipamentos">
          Equipamentos
        </a>

        <a class="nav-item <%= activeMenu === 'os' ? 'active' : '' %>" href="/os">
          Ordens de Serviço
        </a>

        <a class="nav-item <%= activeMenu === 'preventivas' ? 'active' : '' %>" href="/preventivas">
          Preventivas
        </a>

        <a class="nav-item <%= activeMenu === 'compras' ? 'active' : '' %>" href="/solicitacoes">
          Compras
        </a>

        <a class="nav-item <%= activeMenu === 'estoque' ? 'active' : '' %>" href="/estoque">
          Estoque
        </a>

        <a class="nav-item <%= activeMenu === 'escala' ? 'active' : '' %>" href="/escala">
          Escala
        </a>

        <!-- ❌ removido "Usuários" duplicado -->

        <div class="nav-divider"></div>

        <div class="nav-section">ADMIN</div>
        <a class="nav-item <%= activeMenu === 'usuarios' ? 'active' : '' %>" href="/usuarios">
          Gerenciar Usuários
        </a>
      </nav>

      <div class="sidebar-footer">
        <small>© <%= new Date().getFullYear() %> Campo do Gado</small>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <!-- TOPBAR -->
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-title">Manutenção Campo do Gado</div>
          <div class="topbar-sub">V2 • Gestão Industrial</div>
        </div>

        <div class="topbar-right">
          <% if (user) { %>
            <div class="pill">
              <span class="pill-name"><%= user.name || "Usuário" %></span>
              <span class="pill-role"><%= (user.role || "").toUpperCase() %></span>
            </div>

            <form action="/logout" method="POST" style="margin:0;">
              <button class="btn btn-ghost" type="submit">Sair</button>
            </form>
          <% } %>
        </div>
      </header>

      <!-- FLASH -->
      <section class="flash">
        <% if (flash?.error?.length) { %>
          <div class="alert alert-error"><%= flash.error[0] %></div>
        <% } %>
        <% if (flash?.success?.length) { %>
          <div class="alert alert-success"><%= flash.success[0] %></div>
        <% } %>
      </section>

      <!-- CONTENT -->
      <section class="content">
        <%- body %>
      </section>

      <!-- FOOTER -->
      <footer class="footer">
        <div>Manutenção Industrial • Campo do Gado</div>
        <div>© <%= new Date().getFullYear() %> • Sistema V2</div>
      </footer>
    </main>
  </div>
</body>
</html>

<!-- views/layout.ejs -->
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><%= title || "Manutenção Campo do Gado" %></title>

  <link rel="stylesheet" href="/css/app.css" />
</head>

<body>
  <div class="app">

    <!-- ✅ SIDEBAR (partial padronizado) -->
    <%- include("partials/sidebar") %>

    <!-- ===== MAIN ===== -->
    <main class="main">

      <!-- TOPBAR -->
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-title">Manutenção Campo do Gado</div>
          <div class="topbar-sub">Sistema Industrial V2</div>
        </div>

        <div class="topbar-right">
          <% if (user) { %>
            <div class="pill">
              <span class="pill-name"><%= user.name || "Usuário" %></span>
              <span class="pill-role"><%= (user.role || "").toUpperCase() %></span>
            </div>

            <!-- ✅ rota certa -->
            <form action="/auth/logout" method="POST" style="margin:0;">
              <button class="btn btn-ghost" type="submit">Sair</button>
            </form>
          <% } %>
        </div>
      </header>

      <!-- FLASH -->
      <section class="flash">
        <% if (flash?.error?.length) { %>
          <div class="alert alert-error"><%= flash.error[0] %></div>
        <% } %>

        <% if (flash?.success?.length) { %>
          <div class="alert alert-success"><%= flash.success[0] %></div>
        <% } %>
      </section>

      <!-- CONTENT -->
      <section class="content">
        <%- body %>
      </section>

      <!-- FOOTER -->
      <footer class="footer">
        <div>Manutenção Industrial • Campo do Gado</div>
        <div>© <%= new Date().getFullYear() %> • Sistema V2</div>
      </footer>

    </main>
  </div>
</body>
</html>

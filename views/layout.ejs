<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><%= title || "Manutenção Campo do Gado" %></title>

  <link rel="stylesheet" href="/css/app.css" />

  <!-- Ajuste visual do menu (verde bonito) -->
  <style>
    :root{
      --cg-green: #1f7a4f;        /* verde principal */
      --cg-green-dark: #166543;  /* hover */
      --cg-green-soft: #e6f4ee;  /* fundo ativo */
    }

    .nav-item{
      transition: all .2s ease;
    }

    .nav-item:hover{
      background: var(--cg-green-soft);
      color: var(--cg-green);
      font-weight: 600;
    }

    .nav-item.active{
      background: var(--cg-green);
      color: #fff;
      font-weight: 700;
    }

    .nav-item.active:hover{
      background: var(--cg-green-dark);
      color: #fff;
    }
  </style>
</head>

<body>
  <div class="app">
    <!-- SIDEBAR -->
    <aside class="sidebar">
      <div class="brand">
        <div class="brand-badge">CG</div>
        <div class="brand-text">
          <div class="brand-title">Campo do Gado</div>
          <div class="brand-sub">V2 • Gestão Industrial</div>
        </div>
      </div>

      <nav class="nav">
        <a class="nav-item <%= activeMenu === 'dashboard' ? 'active' : '' %>" href="/dashboard">
          Painel
        </a>

        <a class="nav-item <%= activeMenu === 'equipamentos' ? 'active' : '' %>" href="/equipamentos">
          Equipamentos
        </a>

        <a class="nav-item <%= activeMenu === 'os' ? 'active' : '' %>" href="/os">
          Ordens de Serviço
        </a>

        <a class="nav-item <%= activeMenu === 'preventivas' ? 'active' : '' %>" href="/preventivas">
          Preventivas
        </a>

        <a class="nav-item <%= activeMenu === 'compras' ? 'active' : '' %>" href="/solicitacoes">
          Compras
        </a>

        <a class="nav-item <%= activeMenu === 'estoque' ? 'active' : '' %>" href="/estoque">
          Estoque
        </a>

        <a class="nav-item <%= activeMenu === 'escala' ? 'active' : '' %>" href="/escala">
          Escala
        </a>

        <a class="nav-item <%= activeMenu === 'usuarios' ? 'active' : '' %>" href="/usuarios">
          Usuários
        </a>

        <div class="nav-divider"></div>

        <div class="nav-section">ADMIN</div>
        <a class="nav-item <%= activeMenu === 'usuarios' ? 'active' : '' %>" href="/usuarios">
          Gerenciar Usuários
        </a>
      </nav>

      <div class="sidebar-footer">
        <small>© <%= new Date().getFullYear() %> Campo do Gado</small>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main">
      <!-- TOPBAR -->
      <header class="topbar">
        <div class="topbar-left">
          <div class="topbar-title">Manutenção Campo do Gado</div>
          <div class="topbar-sub">V2 • Gestão Industrial</div>
        </div>

        <div class="topbar-right">
          <% if (user) { %>
            <div class="pill">
              <span class="pill-name"><%= user.name || "Usuário" %></span>
              <span class="pill-role"><%= (user.role || "").toUpperCase() %></span>
            </div>

            <form action="/logout" method="POST" style="margin:0;">
              <button class="btn btn-ghost" type="submit">Sair</button>
            </form>
          <% } %>
        </div>
      </header>

      <!-- FLASH -->
      <section class="flash">
        <% if (flash?.error?.length) { %>
          <div class="alert alert-error"><%= flash.error[0] %></div>
        <% } %>
        <% if (flash?.success?.length) { %>
          <div class="alert alert-success"><%= flash.success[0] %></div>
        <% } %>
      </section>

      <!-- CONTENT -->
      <section class="content">
        <%- body %>
      </section>

      <!-- FOOTER -->
      <footer class="footer">
        <div>Manutenção Industrial • Campo do Gado</div>
        <div>© <%= new Date().getFullYear() %> • Sistema V2</div>
      </footer>
    </main>
  </div>
</body>
</html>
